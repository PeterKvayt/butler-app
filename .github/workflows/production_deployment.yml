name: Production CI/CD
run-name: Deploy ðŸš€ to ${{ inputs.deploy_target }} by @${{ github.actor }} 
on:
  push:
    branches: [main]
jobs:
  deploy:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
    - name: Vars test
      run: echo "MY_REPO_VAR - ${{ vars.MY_REPO_VAR }}; MY_REPO_SECRET - ${{ vars.MY_REPO_SECRET }}; MY_ENV_VAR - ${{ vars.MY_ENV_VAR }}; MY_ENV_VAR_SECRET - ${{ vars.MY_ENV_VAR_SECRET }};"
    - name: Pull the repo
      uses: actions/checkout@v5
    - name: Setup .NET
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 10.0.102
    - name: Restore
      run: dotnet restore
    # cache restore if not exists https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax#jobsjob_idstepsif
    # - name: Cache restore
    #   uses: actions/cache@v4
    #   with:
    #     path: |
    #       ~/.gradle/caches
    #       ~/.gradle/wrapper
    - name: Build
      run: dotnet build --no-restore -c Release
    - name: Publish
      run: dotnet publish src/Api/Api.csproj -o src/Api/bin/publish -c Release -v n --no-build
    #- name: Deploy to FTP
    # - uses: SamKirkland/FTP-Deploy-Action@v4.3.6
    #   with:
    #     server: ftp.samkirkland.com
    #     username: myFtpUserName
    #     password: ${{ secrets.password }}
    #     dry-run: true